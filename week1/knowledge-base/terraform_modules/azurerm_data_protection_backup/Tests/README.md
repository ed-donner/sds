# Infra Team Test

This is a test for the Infra team to check the quality of the code and the documentation.

## Notes

Any notes or comments for the Infra team can be added here. (Please add any notes or comments with a date DD/MM/YYYY)

## Terraform Docs

<!-- BEGIN_TF_DOCS -->
## Requirements

| Name | Version |
|------|---------|
| <a name="requirement_azuread"></a> [azuread](#requirement\_azuread) | 3.1.0 |
| <a name="requirement_azurerm"></a> [azurerm](#requirement\_azurerm) | 4.22.0 |

## Providers

No providers.

## Modules

| Name | Source | Version |
|------|--------|---------|
| <a name="module_data_protection_backup_vault"></a> [data\_protection\_backup\_vault](#module\_data\_protection\_backup\_vault) | git::ssh://git@ssh.dev.azure.com/v3/Axpo-AXSO/TIM-INFRA-MODULES/azurerm_data_protection_backup | ~{gitRef}~ |

## Resources

No resources.

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| <a name="input_blob_storage_backup_config"></a> [blob\_storage\_backup\_config](#input\_blob\_storage\_backup\_config) | Specifies the configuration for blob storage backups. This variable defines a list of backup configurations, associating blob storage resources with their respective backup policies.<br><br>Attributes:<br>- **storage\_account\_name** (Required): The name of the blob storage account. This must be unique within the context of your Terraform configuration.<br>- **resource\_group\_name** (Required): The name of the Azure Resource Group where the blob storage resides.<br>- **blob\_storage\_backup\_policy\_name** (Required): The name of the backup policy to be applied to the blob storage. This should correspond to an existing backup policy defined within your Azure environment.<br><br>Default: An empty list, meaning no backup configurations are defined unless explicitly specified.<br><br>Note: Changing the attributes in this variable will force updates to the associated backup configurations. | <pre>list(object({<br>    storage_account_name            = string<br>    resource_group_name             = string<br>    blob_storage_backup_policy_name = string<br>    storage_account_container_names = list(string)<br>  }))</pre> | `[]` | no |
| <a name="input_blob_storage_backup_policy"></a> [blob\_storage\_backup\_policy](#input\_blob\_storage\_backup\_policy) | Specifies the backup policy for blob storage. This variable allows you to define a list of backup policies with detailed attributes. Changing any of these attributes forces the creation of a new Backup Policy for the blob storage.<br><br>Attributes:<br>- **blob\_storage\_backup\_policy\_name** (Required): The name of the backup policy. Changing this forces a new Backup Policy to be created.<br>- **backup\_repeating\_time\_intervals** (Optional): A list of repeating time intervals for backups. These intervals must adhere to the ISO 8601 repeating interval format. Changing this forces a new Backup Policy to be created.<br>- **operational\_default\_retention\_duration** (Required): The duration of the operational default retention rule. This must follow the ISO 8601 duration format. Changing this forces a new Backup Policy to be created.<br>- **vault\_default\_retention\_duration** (Optional): The vault's default retention duration. Changing this forces a new Backup Policy to be created.<br>- **time\_zone** (Optional): Specifies the time zone to be used by the backup schedule. Changing this forces a new Backup Policy to be created.<br>- **retention\_rule** (Optional): Defines the retention rules for the backup policy, including:<br>  - **name** (Required): The name of the retention rule.<br>  - **duration** (Required): The duration of the retention rule, following the ISO 8601 duration format.<br>  - **priority** (Required): The priority of the retention rule.<br>  - **criteria** (Optional): Additional criteria for the retention rule, including:<br>    - **absolute\_criteria** (Optional): An optional absolute criteria string.<br>    - **days\_of\_month** (Optional): A list of days of the month for the backup schedule.<br>    - **days\_of\_week** (Optional): A list of days of the week for the backup schedule.<br>    - **months\_of\_year** (Optional): A list of months of the year for the backup schedule.<br>    - **scheduled\_backup\_times** (Optional): A list of specific backup times in HH:mm:ss format.<br>    - **weeks\_of\_month** (Optional): A list of weeks of the month for the backup schedule.<br>  - **lifecycle** (Required): Specifies lifecycle management settings for the retention rule, including:<br>    - **data\_store\_type** (Required): The type of data store for lifecycle management.<br>    - **duration** (Required): The duration for lifecycle management, following the ISO 8601 duration format.<br><br>Note: Changing any of these attributes forces a new Backup Policy to be created for the specified blob storage. | <pre>list(object({<br>    blob_storage_backup_policy_name        = string<br>    backup_repeating_time_intervals        = optional(list(string))<br>    operational_default_retention_duration = string<br>    vault_default_retention_duration       = optional(string)<br>    time_zone                              = optional(string)<br>    retention_rule = optional(list(object({<br>      name     = string<br>      duration = string<br>      priority = number<br>      criteria = optional(object({<br>        absolute_criteria      = optional(string)<br>        days_of_month          = optional(list(number))<br>        days_of_week           = optional(list(string))<br>        months_of_year         = optional(list(string))<br>        scheduled_backup_times = optional(list(string))<br>        weeks_of_month         = optional(list(string))<br>      }))<br>      lifecycle = object({<br>        data_store_type = string<br>        duration        = string<br>      })<br>    })))<br>  }))</pre> | `[]` | no |
| <a name="input_cross_region_restore_enabled"></a> [cross\_region\_restore\_enabled](#input\_cross\_region\_restore\_enabled) | (Optional) Specifies whether cross-region restore is enabled. Changing this forces a new Backup Vault to be created. | `bool` | `false` | no |
| <a name="input_datastore_type"></a> [datastore\_type](#input\_datastore\_type) | (Required) Specifies the type of the data store. Possible values are ArchiveStore, OperationalStore, and VaultStore. Changing this forces a new resource to be created<br>  *VaultStore*: It stores backups in the Azure Blob service,It's designed to provide high availability for backup data. Vault Store provides good performance for backup and recovery operations.<br>  *SnapshotStore*: It is used for frequent backups and is crucial when the ability to quickly capture and recover from point-in-time changes is important.<br>  *ArchiveStore*: It is used for a long time, especially for data that is rarely accessed and has extended retention periods, ArchiveStore is a cost-effective option. | `string` | `"VaultStore"` | no |
| <a name="input_environment"></a> [environment](#input\_environment) | The environment. e.g. dev, qa, uat, prod | `string` | `"dev"` | no |
| <a name="input_kubernetes_cluster_backup_config"></a> [kubernetes\_cluster\_backup\_config](#input\_kubernetes\_cluster\_backup\_config) | Defines the backup configuration for Kubernetes clusters, specifying backup policies, cluster details, and backup parameters.<br><br>### Attributes:<br>- **resource\_group\_name** (Required): The name of the Azure Resource Group where the Kubernetes cluster is deployed.<br>- **kubernetes\_cluster\_name** (Required): The name of the Kubernetes cluster. It must be unique within your Terraform configuration.<br>- **kubernetes\_cluster\_backup\_policy\_name** (Required): The name of the backup policy applied to the Kubernetes cluster. This must reference an existing backup policy in Azure.<br>- **kubernetes\_cluster\_id** (Required): The full resource ID of the Kubernetes cluster.<br>- **kubernetes\_cluster\_identity\_data\_object** (Optional, default = `true`): Indicates whether the identity object should be automatically derived using a data source. Set to `false` to skip lookup and use a provided identity ID directly.<br>- **kubernetes\_cluster\_identity\_object\_id** (Optional): The object ID of the managed identity assigned to the Kubernetes cluster. Required if `kubernetes_cluster_identity_data_object` is `false`.<br>- **kubernetes\_cluster\_resource\_group\_name** (Optional): The resource group name where the Kubernetes cluster resides. Required if using a data source to fetch cluster identity and the cluster is not in the default resource group.<br><br>### Backup Data Source Parameters:<br>- **excluded\_namespaces** (Required): A list of namespaces to exclude from the backup.<br>- **excluded\_resource\_types** (Required): A list of Kubernetes resource types to exclude from the backup.<br>- **cluster\_scoped\_resources\_enabled** (Required): Boolean flag indicating whether cluster-scoped resources should be included in the backup.<br>- **included\_namespaces** (Optional): A list of namespaces to include in the backup. If not specified, all namespaces except those explicitly excluded are included.<br>- **included\_resource\_types** (Required): A list of Kubernetes resource types to include in the backup.<br>- **label\_selectors** (Required): A list of label selectors to filter resources for backup.<br>- **volume\_snapshot\_enabled** (Required): Boolean flag indicating whether volume snapshots should be included in the backup.<br><br>### Default:<br>The default value is an empty list (`[]`), meaning no backup configurations are defined unless explicitly provided.<br><br>### Note:<br>Modifying any attribute in this variable will trigger updates to the associated backup configurations. Use caution when overriding optional fields like identity information. | <pre>list(object({<br>    resource_group_name                     = string<br>    kubernetes_cluster_backup_policy_name   = string<br>    kubernetes_cluster_name                 = string<br>    kubernetes_cluster_id                   = string<br>    kubernetes_cluster_identity_data_object = optional(bool, true)<br>    kubernetes_cluster_identity_object_id   = optional(string)<br>    kubernetes_cluster_resource_group_name  = optional(string)<br>    backup_datasource_parameters = object({<br>      excluded_namespaces              = list(string)<br>      excluded_resource_types          = list(string)<br>      cluster_scoped_resources_enabled = bool<br>      included_namespaces              = optional(list(string))<br>      included_resource_types          = list(string)<br>      label_selectors                  = list(string)<br>      volume_snapshot_enabled          = bool<br>    })<br>  }))</pre> | `[]` | no |
| <a name="input_kubernetes_cluster_backup_policy"></a> [kubernetes\_cluster\_backup\_policy](#input\_kubernetes\_cluster\_backup\_policy) | Specifies the backup policy for Kubernetes clusters. This variable allows you to define a list of backup policies with detailed attributes. Changing any of these attributes forces the creation of a new Backup Policy for the Kubernetes cluster.<br><br>Attributes:<br>- **kubernetes\_cluster\_backup\_policy\_name** (Required): The name of the backup policy. Changing this forces a new Backup Policy to be created.<br>- **resource\_group\_name** (Required): The name of the Azure Resource Group where the Kubernetes cluster resides.<br>- **vault\_name** (Required): The name of the backup vault associated with the policy.<br>- **backup\_repeating\_time\_intervals** (Optional): A list of repeating time intervals for backups. These intervals must adhere to the ISO 8601 repeating interval format. Changing this forces a new Backup Policy to be created.<br>- **time\_zone** (Optional): Specifies the time zone to be used by the backup schedule. Changing this forces a new Backup Policy to be created.<br>- **retention\_rule** (Optional): Defines the retention rules for the backup policy, including:<br>  - **name** (Required): The name of the retention rule.<br>  - **priority** (Required): The priority of the retention rule.<br>  - **criteria** (Optional): Specifies additional criteria for the retention rule, including:<br>    - **absolute\_criteria** (Optional): Specifies an optional absolute criteria string.<br>    - **days\_of\_week** (Optional): A list of days of the week for the backup schedule.<br>    - **months\_of\_year** (Optional): A list of months of the year for the backup schedule.<br>    - **scheduled\_backup\_times** (Optional): A list of specific backup times in HH:mm:ss format.<br>    - **weeks\_of\_month** (Optional): A list of weeks of the month for the backup schedule.<br>  - **lifecycle** (Required): Specifies lifecycle management settings for the retention rule, including:<br>    - **duration** (Required): The duration for lifecycle management, following the ISO 8601 duration format.<br><br>Note: Changing any of these attributes forces a new Backup Policy to be created for the specified Kubernetes cluster. | <pre>list(object({<br>    kubernetes_cluster_backup_policy_name = string<br>    resource_group_name                   = string<br>    vault_name                            = string<br>    backup_repeating_time_intervals       = optional(list(string))<br>    time_zone                             = optional(string)<br>    default_retention_rule = optional(object({<br>      lifecycle = object({<br>        duration = string<br>      })<br>    }))<br>    retention_rule = optional(list(object({<br>      name     = string<br>      priority = number<br>      criteria = optional(object({<br>        absolute_criteria      = optional(string)<br>        days_of_week           = optional(list(string))<br>        months_of_year         = optional(list(string))<br>        scheduled_backup_times = optional(list(string))<br>        weeks_of_month         = optional(list(string))<br>      }))<br>      lifecycle = object({<br>        duration = string<br>      })<br>    })))<br>  }))</pre> | `[]` | no |
| <a name="input_kubernetes_cluster_storage_account_config"></a> [kubernetes\_cluster\_storage\_account\_config](#input\_kubernetes\_cluster\_storage\_account\_config) | Specifies the configuration for Kubernetes cluster storage accounts used for backups. This variable defines the necessary attributes to associate Kubernetes cluster resources with their respective Azure storage accounts for backup purposes.<br><br>Attributes:<br>- **kubernetes\_cluster\_backup\_storage\_account\_name** (Required): The name of the Azure Storage Account used for Kubernetes cluster backups.<br>- **kubernetes\_cluster\_backup\_storage\_account\_resource\_group\_name** (Required): The name of the Azure Resource Group where the storage account is located.<br>- **kubernetes\_cluster\_backup\_storage\_account\_blob\_name** (Required): The name of the blob container within the storage account where the backups will be stored.<br>- **create\_cluster\_backup\_storage\_account\_blob** (Required): Indicate whether the Blob Storage needs to be created. If not, it is assumed that it already exists.<br><br>Default: An empty object, indicating no storage account configurations are defined unless explicitly specified.<br><br>Note: Modifying these attributes will trigger updates to the associated Kubernetes cluster backup configurations in Terraform. | <pre>object({<br>    kubernetes_cluster_backup_storage_account_name                = optional(string)<br>    kubernetes_cluster_backup_storage_account_resource_group_name = optional(string)<br>    kubernetes_cluster_backup_storage_account_blob_name           = optional(string)<br>    create_cluster_backup_storage_account_blob                    = optional(bool)<br>  })</pre> | `{}` | no |
| <a name="input_location"></a> [location](#input\_location) | Azure location. | `string` | `"West Europe"` | no |
| <a name="input_managed_disk_backup_config"></a> [managed\_disk\_backup\_config](#input\_managed\_disk\_backup\_config) | Specifies the configuration for managed disk backups. This variable defines a list of backup configurations, associating managed disk resources with their respective backup policies.<br><br>Attributes:<br>- **disk\_name** (Required): The name of the managed disk. This must be unique within the context of your Terraform configuration.<br>- **resource\_group\_name** (Required): The name of the Azure Resource Group where the managed disk resides.<br>- **managed\_disk\_backup\_policy\_name** (Required): The name of the backup policy to be applied to the managed disk. This should correspond to an existing backup policy defined within your Azure environment.<br><br>Default: An empty list, meaning no backup configurations are defined unless explicitly specified.<br><br>Note: Changing the attributes in this variable will force updates to the associated backup configurations. | <pre>list(object({<br>    disk_name                       = string<br>    resource_group_name             = string<br>    managed_disk_backup_policy_name = string<br>  }))</pre> | `[]` | no |
| <a name="input_managed_disk_backup_policy"></a> [managed\_disk\_backup\_policy](#input\_managed\_disk\_backup\_policy) | Specifies the backup policy for managed disks. This variable allows you to define a list of backup policies with detailed attributes. Changing the attributes of a backup policy forces the creation of a new Backup Policy for the managed disks.<br><br>Attributes:<br>- **managed\_disk\_backup\_policy\_name** (Required): The name of the backup policy. Changing this forces a new Backup Policy to be created.<br>- **backup\_repeating\_time\_intervals** (Optional): A list of repeating time intervals for backups. These intervals must adhere to the ISO 8601 repeating interval format. Changing this forces a new Backup Policy to be created.<br>- **default\_retention\_duration** (Required): The default retention duration for the backup policy. This must follow the ISO 8601 duration format. Changing this forces a new Backup Policy to be created.<br>- **time\_zone** (Optional): Specifies the time zone to be used by the backup schedule. Changing this forces a new Backup Policy to be created.<br>- **retention\_rule** (Optional): Defines the retention rules for the backup policy. This includes:<br>  - **name** (Required): The name of the retention rule.<br>  - **duration** (Required): The duration of the retention rule, following the ISO 8601 duration format.<br>  - **priority** (Required): The priority of the retention rule.<br>  - **criteria** (Optional): Specifies additional criteria for the retention rule, including:<br>    - **absolute\_criteria** (Optional): An optional absolute criteria string.<br><br>Note: Changing any of these attributes forces a new Backup Policy to be created for the specified managed disks. | <pre>list(object({<br>    managed_disk_backup_policy_name = string<br>    backup_repeating_time_intervals = optional(list(string))<br>    default_retention_duration      = string<br>    time_zone                       = optional(string)<br>    retention_rule = optional(list(object({<br>      name     = string<br>      duration = string<br>      priority = number<br>      criteria = optional(object({<br>        absolute_criteria = optional(string)<br>      }))<br>    })))<br>  }))</pre> | `[]` | no |
| <a name="input_project_name"></a> [project\_name](#input\_project\_name) | The name of the project. e.g. MDS | `string` | `"project"` | no |
| <a name="input_psql_flexible_server_backup_config"></a> [psql\_flexible\_server\_backup\_config](#input\_psql\_flexible\_server\_backup\_config) | Specifies the configuration for PSQL Flexible Server backups. This variable defines a list of backup configurations, associating PSQL Flexible Server resources with their respective backup policies.<br><br>Attributes:<br>- **resource\_group\_name** (Required): The name of the Azure Resource Group where the PSQL Flexible Server resides.<br>- **psql\_flexible\_server\_name** (Required): The name of the PSQL Flexible Server to be backed up.<br>- **psql\_flexible\_server\_backup\_policy\_name** (Required): The name of the backup policy to be applied to the PSQL Flexible Server. This should correspond to an existing backup policy defined within your Azure environment.<br><br>Default: An empty list, meaning no backup configurations are defined unless explicitly specified.<br><br>Note: Changing the attributes in this variable will force updates to the associated backup configurations. | <pre>list(object({<br>    resource_group_name                     = string<br>    psql_flexible_server_name               = string<br>    psql_flexible_server_backup_policy_name = string<br>  }))</pre> | `[]` | no |
| <a name="input_psql_flexible_server_backup_policy"></a> [psql\_flexible\_server\_backup\_policy](#input\_psql\_flexible\_server\_backup\_policy) | Specifies the backup policy for PSQL Flexible Servers. This variable allows you to define a list of backup policies with detailed attributes. Changing any of these attributes forces the creation of a new Backup Policy for the PSQL Flexible Server.<br><br>Attributes:<br>- **psql\_flexible\_server\_backup\_policy\_name** (Required): The name of the backup policy. Changing this forces a new Backup Policy to be created.<br>- **backup\_repeating\_time\_intervals** (Optional): A list of repeating time intervals for backups. These intervals must adhere to the ISO 8601 repeating interval format. Changing this forces a new Backup Policy to be created.<br>- **time\_zone** (Optional): Specifies the time zone to be used by the backup schedule. Changing this forces a new Backup Policy to be created.<br>- **default\_retention\_rule** (Optional): Specifies the default lifecycle retention rule for the backup policy, including:<br>  - **lifecycle** (Required): Specifies lifecycle management settings, including:<br>    - **duration** (Required): The duration for lifecycle management, following the ISO 8601 duration format.<br>- **retention\_rule** (Optional): Defines additional retention rules for the backup policy, including:<br>  - **name** (Required): The name of the retention rule.<br>  - **priority** (Required): The priority of the retention rule.<br>  - **criteria** (Optional): Specifies additional criteria for the retention rule, including:<br>    - **absolute\_criteria** (Optional): Specifies an optional absolute criteria string.<br>    - **days\_of\_week** (Optional): A list of days of the week for the backup schedule.<br>    - **months\_of\_year** (Optional): A list of months of the year for the backup schedule.<br>    - **scheduled\_backup\_times** (Optional): A list of specific backup times in RFC3339 format.<br>    - **weeks\_of\_month** (Optional): A list of weeks of the month for the backup schedule.<br>  - **lifecycle** (Required): Specifies lifecycle management settings for the retention rule, including:<br>    - **duration** (Required): The duration for lifecycle management, following the ISO 8601 duration format.<br><br>Note: Changing any of these attributes forces a new Backup Policy to be created for the specified PSQL Flexible Server. | <pre>list(object({<br>    psql_flexible_server_backup_policy_name = string<br>    backup_repeating_time_intervals         = optional(list(string))<br>    time_zone                               = optional(string)<br>    default_retention_rule = optional(object({<br>      lifecycle = object({<br>        duration = string<br>      })<br>    }))<br>    retention_rule = optional(list(object({<br>      name     = string<br>      priority = number<br>      criteria = optional(object({<br>        absolute_criteria      = optional(string)<br>        days_of_week           = optional(list(string))<br>        months_of_year         = optional(list(string))<br>        scheduled_backup_times = optional(list(string))<br>        weeks_of_month         = optional(list(string))<br>      }))<br>      lifecycle = object({<br>        duration = string<br>      })<br>    })))<br>  }))</pre> | `[]` | no |
| <a name="input_redundancy"></a> [redundancy](#input\_redundancy) | (Required) Specifies the backup storage redundancy. Possible values are GeoRedundant, LocallyRedundant and ZoneRedundant. Changing this forces a new Backup Vault to be created. | `string` | `"GeoRedundant"` | no |
| <a name="input_resource_group_name"></a> [resource\_group\_name](#input\_resource\_group\_name) | The name of the resource group that contains the data factory | `string` | n/a | yes |
| <a name="input_retention_duration_in_days"></a> [retention\_duration\_in\_days](#input\_retention\_duration\_in\_days) | (Optional) Specifies the retention duration for the backup data in days. Changing this forces a new Backup Vault to be created. | `number` | `14` | no |
| <a name="input_snapshot_resource_group_id"></a> [snapshot\_resource\_group\_id](#input\_snapshot\_resource\_group\_id) | The id of the resource group where the snapshot resides. | `string` | n/a | yes |
| <a name="input_soft_delete"></a> [soft\_delete](#input\_soft\_delete) | (Optional) Specifies whether soft delete is enabled. Changing this forces a new Backup Vault to be created. | `string` | `"Off"` | no |
| <a name="input_subscription"></a> [subscription](#input\_subscription) | The subscription type e.g. 'p' for prod or 'np' for nonprod | `string` | `"np"` | no |

## Outputs

No outputs.
<!-- END_TF_DOCS -->